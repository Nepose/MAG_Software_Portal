"use strict";function checkEnvVars(){return!1}function getWindowKey(windowName){return"window."+windowName+".id"}function getWindowIdByName(windowName){return stbStorage.getItem(getWindowKey(windowName))}function openWindow(windowName,url){var windowInfo,windowKey=getWindowKey(windowName),windowID=stbStorage.getItem(windowKey);if(windowID)try{windowInfo=JSON.parse(stbWindowMgr.windowInfo(windowID)),-1===windowInfo.result.url.indexOf(url)&&stbWebWindow.messageSend(windowID,"window.load",url),windowName===WINDOWS.BROWSER?(windowID=stbWindowMgr.openWebFace(url),stbStorage.setItem(windowKey,windowID)):stbWindowMgr.windowShow(windowID)}catch(e){echo(e),stbWindowMgr.openWebFace(url)}else windowID=windowName===WINDOWS.BROWSER?stbWindowMgr.openWebFace(url):stbWindowMgr.windowInit(JSON.stringify({url:url,backgroundColor:"#000"})),stbStorage.setItem(windowKey,windowID);return windowID}function openWindowHelp(path){openWindow(WINDOWS.HELP,PATH_ROOT+"public/app/help/index.html?path="+path)}function elattr(obj,attr){if(obj&&obj.nodeType&&attr&&attr instanceof Object)for(var key in attr)attr.hasOwnProperty(key)&&(obj[key]=attr[key]);return obj}function element(name,attr,data){var tag=document.createElement(name);return elattr(tag,attr),elchild(tag,data),tag}function elchild(obj,value){if(obj&&value)if(value.nodeType)obj.appendChild(value);else if(Array.isArray(value))for(var i=0;i<value.length;i++)elchild(obj,value[i]);else obj.appendChild(document.createTextNode(value));return obj}function elclear(obj){if(null!==obj&&obj.nodeName&&obj.hasChildNodes())for(;obj.hasChildNodes();)obj.removeChild(obj.firstChild);return obj}function loadScript(src,onload,onerror){var elem=document.createElement("script");elem.type="text/javascript",elem.src=src,"function"==typeof onload&&(elem.onload=onload),"function"==typeof onerror&&(elem.onerror=onerror),document.head.appendChild(elem)}function getCurrentLanguage(langList){var langEnv=JSON.parse(gSTB.GetEnv('{"varList":["language"]}')),langVal="en";return langList=langList||["en","ru","uk","de","tr"],!langEnv.errMsg&&langEnv.result&&langEnv.result.language&&"string"==typeof langEnv.result.language&&(langEnv.result.language=langEnv.result.language.toLowerCase(),-1!==langList.indexOf(langEnv.result.language)&&(langVal=langEnv.result.language)),langVal}function getEnvList(list){var data;try{if(data=JSON.parse(gSTB.GetEnv(JSON.stringify({varList:list}))),""!==data.errMsg)throw new Error(data.errMsg);return data.result}catch(e){echo(e)}return!1}function getEnv(name){var data=getEnvList([name]);return data!==!1&&void 0!==data[name]?data[name]:data}function setEnv(key,value){var vars={};return vars[key]=value,setEnvList(vars)}function setEnvList(hash){try{return gSTB.SetEnv(JSON.stringify(hash))}catch(e){echo(e)}return!1}function eventPrepare(event,stopBubble,label){return void 0!==event.code?!0:(event.code=event.keyCode||event.which,0===event.code?!1:(event.shiftKey&&(event.code+=1e3),event.altKey&&(event.code+=2e3),event.code===KEYS.USB_MOUNTED||event.code===KEYS.USB_UNMOUNTED?!1:(stopBubble!==!1&&event.stopPropagation(),echo(event.code+"	"+event.shiftKey+"	"+event.ctrlKey+"	"+event.altKey+"	"+event.srcElement.id+"	"+event.target.id+"	"+(label||""),"keyDown [code/shift/ctrl/alt/src/target]"),!0)))}function ajax(method,url,callback,headers,type,async){var hname,jdata=null,timeout=null,xhr=new XMLHttpRequest,title="AJAX "+method.toUpperCase()+" "+url;if(async=async!==!1,xhr.onreadystatechange=function(){if(4===xhr.readyState)if(clearTimeout(timeout),ajax.stop)echo(xhr.status,title),"function"==typeof callback&&callback(null,null,null);else{if(echo("status:"+xhr.status+", length:"+xhr.responseText.length,title),"json"===type&&200===xhr.status)try{jdata=JSON.parse(xhr.responseText)}catch(e){echo(e,"AJAX JSON.parse"),jdata=null}"function"==typeof callback&&callback("xml"===type?xhr.responseXML:"json"===type?jdata:xhr.responseText,xhr.status,xhr)}},xhr.open(method,url,async),headers)for(hname in headers)headers.hasOwnProperty(hname)&&xhr.setRequestHeader(hname,headers[hname]);return xhr.send(),echo("sent",title),timeout=setTimeout(function(){xhr.abort(),echo("ABORT on timeout",title),"function"==typeof callback&&callback(null,0)},6e4),xhr}function imageLoader(imgList,callback){var count=1,onload=function(){imgList.length===count&&"function"==typeof callback?callback():count++};Array.isArray(imgList)&&imgList.length>0?imgList.forEach(function(item){var img=new Image;img.src=item,img.onload=onload,img.onerror=function(){throw"Image "+item+" load fail"}}):0===imgList.length&&callback()}function getStorageInfo(){var snList={},info=JSON.parse(gSTB.GetStorageInfo("{}"));Array.isArray(info.result)&&""===info.errMsg&&info.result.length>0?(info.result.forEach(function(item){item.mediaType="000022272228"===item.sn?3:item.mediaType,item.label=item.label.trim(),snList[item.sn]?snList[item.sn]++:snList[item.sn]=1}),info.result.forEach(function(item){item.label||(item.label=item.vendor+" "+item.model.replace(/\//,""),snList[item.sn]>1&&(item.label+=" #"+item.partitionNum)),item.isReadOnly&&(item.label+=" ("+_("Read only")+")")}),info.result.sort(function(a,b){return a.mountPath<b.mountPath?-1:1}),window.STORAGE_INFO=info.result):window.STORAGE_INFO=[];try{window.HDD_INFO=JSON.parse(gSTB.RDir("get_hdd_info")||"[]")}catch(e){echo(e,"get_hdd_info"),window.HDD_INFO=[]}echo(STORAGE_INFO,"STORAGE_INFO"),echo(HDD_INFO,"HDD_INFO")}function parseUri(str){for(var o=parseUri.options,m=o.parser[o.strictMode?"strict":"loose"].exec(str),uri={},i=14;i--;)uri[o.key[i]]=m[i]||"";return uri[o.q.name]={},uri[o.key[12]].replace(o.q.parser,function($0,$1,$2){$1&&(uri[o.q.name][$1]=$2)}),uri}function validateUrl(url,sol,isSolutionOptional,isProtocolOptional){var solReg="((ffmpeg|auto|rtp|rtsp|mp3|mpegps|mpegts|mp4|ifm|fm|ffrt|ffrt2|ffrt3|ffrt4)(\\s))";return isProtocolOptional=typeof isProtocolOptional==typeof!0?isProtocolOptional:!0,new RegExp("^"+(sol?solReg:"")+["","?"][+!!isSolutionOptional]+"(((http|https|udp|rtp|rtsp|mms|mmsh|mmst|rtmp|igmp):\\/\\/)"+["","?"][+isProtocolOptional]+"@?(([a-zA-Z0-9а-яА-Я$\\-_.+!*'(),;:&=]|%[0-9a-fA-Fа-яА-Я]{2})+@)?(((25[0-5]|2[0-4][0-9]|[0-1][0-9][0-9]|[1-9][0-9]|[0-9])(\\.(25[0-5]|2[0-4][0-9]|[0-1][0-9][0-9]|[1-9][0-9]|[0-9])){3})|localhost|([a-zA-Zа-яА-Я0-9\\-\\u00C0-\\u017F]+\\.)+([a-zA-Zа-яА-Я]{2,}))(:[0-9]+)?|((file:///|/)[a-zA-Zа-яА-Я0-9\\-\\u00C0-\\u017F]+))(\\/(([a-zA-Zа-яА-Я0-9$\\-_.+!*'(),;:@&=\\s]|%[0-9a-fA-Fа-яА-Я]{2})*(\\/([a-zA-Zа-яА-Я0-9$\\-_.+!*'(),;:@&=\\s]|%[0-9a-fA-Fа-яА-Я]{2})*)*)?(\\?([a-zA-Zа-яА-Я0-9$\\-_.+!*'(),;:@&=\\/?]|%[0-9a-fA-Fа-яА-Я]{2})*)?(\\#([a-zA-Zа-яА-Я0-9$\\-_.+!*'(),;:@&=\\/?]|%[0-9a-fA-Fа-яА-Я]{2})*)?)?$").test(url)}function extend(target,source,override){var _target=override===!1?extend({},target):target||{};for(var prop in source)"object"!=typeof _target[prop]||"object"!=typeof source[prop]||Array.isArray(_target[prop])||Array.isArray(source[prop])?_target[prop]=source[prop]:_target[prop]=extend(_target[prop],source[prop],override);return _target}function base64Encode(data){return btoa(unescape(encodeURIComponent(data)))}function base64Decode(data){try{return decodeURIComponent(escape(atob(data)))}catch(error){echo(error,"base64Decode Error")}}function cutTextWithEllipsis(text,length){return text.length>length?text.toString().slice(0,length)+"...":text}function parseDate(dateStr){if(!dateStr)return new Date(NaN);var date=new Date(dateStr.match(/\w{3}\s\w{3}\s\d{1,2}\s\d{1,2}:\d{1,2}:\d{1,2}/)+" "+dateStr.match(/\d{4}/)),timeZone=dateStr.match(/(\w{1,4}|((\+|-)\d{1,2}))\s+\d{4}/)[1],offset=timeZoneOffsets[timeZone];return date.setMinutes(date.getMinutes()-date.getTimezoneOffset()),0!==offset.index&&date.setMinutes(date.getMinutes()+(offset.minutes||0)*offset.index),date}function getMediaType(file){var extension=file.split(".").pop().toLowerCase();if(extension&&-1!==configuration.registersTypes.indexOf(extension))for(var type,i=0;i<MEDIA_TYPES.length,type=MEDIA_TYPES[i];i++)if(-1!==MEDIA_EXTENSION[type].indexOf(extension))return type;return MEDIA_TYPE_NONE}function readJSON(path,fileName){var result,xmlhttp=new XMLHttpRequest;path=path+"/"+fileName;try{xmlhttp.open("GET",path,!1),xmlhttp.send(null),result=xmlhttp.responseText}catch(e){echo(e,"some xmlhttp error"),result=""}return echo(result,"file "+path),result}function CBase(parent){this.name="CBase",this.handle=null,this.parent=null,this.handleInner=null,this.showAttr="block",this.baseClass="",this.prevFocus=null,this.isActive=!1,this.activeChild=null,this.isVisible=!0,this.SetParent(parent)}function CPage(parent){CBase.call(this,parent||null),this.name="CPage",this.previous=null,this.isVisible=!1}function CScrollList(parent){CBase.call(this,parent),this.name="CScrollList",this.baseClass="cslist-main",this.multipleSelection=!0,this.activeItem=null,this.states={},this.manageFocus=!0,this.defaultParams={hidden:!1,marked:!1,disabled:!1,focused:!1,href:"#",self:this,manageFocus:!0,oncontextmenu:EMULATION?null:function(){return!1},onclick:function(){return this.self.Focused(this,!0),!1},onmouseover:function(){return this.self.Focused(this,!0),!1}},this.defaultFilter={hidden:!1,disabled:!1},this.scrollMode=2,this.RENDER_MODE_SINGLE=1,this.RENDER_MODE_BULK=2,this.renderMode=this.RENDER_MODE_SINGLE,this.fragment=document.createDocumentFragment()}function CButtonPanel(parent){CBase.call(this,parent),this.name="CButtonPanel",this.baseClass="cbpanel-main",this.path="",this.isActive=!0}function CModal(parent){CPage.call(this,parent),this.name="CModal",this.baseClass="cmodal-main",this.showAttr="table",this.focusList=[],this.focusPos=0}function CModalBox(parent){CModal.call(this,parent),this.name="CModalBox",this.header=element("div",{className:"cmodal-header"}),this.content=element("div",{className:"cmodal-content"}),this.footer=element("div",{className:"cmodal-footer"})}function CModalHint(parent,data,time,isForced){if(data){CModalBox.call(this,parent),this.name="CModalHint";var self=this;this.SetHeader(),this.SetContent(data),this.SetFooter(),this.onHide=function(){self.Free()},this.onClick=function(){self.Show(!1)},this.Init(),this.Show(!0),isForced!==!0&&(this.EventHandler=function(event){self.Show(!1),self.timer&&clearTimeout(self.timer),event.preventDefault()}),time&&(this.timer=setTimeout(function(){self.Show(!1)},time||5e3))}}function CModalAlert(parent,title,data,btnExitTitle,btnExitClick){if(data){CModalBox.call(this,parent),this.name="CModalAlert";var self=this;this.bpanel=new CButtonPanel,this.bpanel.Init(CMODAL_IMG_PATH),this.bpanel.btnExit=this.bpanel.Add(KEYS.EXIT,"exit.png",btnExitTitle||"",function(){"function"==typeof btnExitClick&&btnExitClick.call(self),self.Show(!1)}),this.SetHeader(title),this.SetContent(data),this.SetFooter(this.bpanel.handle),this.onHide=function(){elclear(self.bpanel.handle),delete self.bpanel,self.Free()},this.EventHandler=function(e){eventPrepare(e,!0,this.name)&&self.bpanel.EventHandler(e)},this.Init(),this.Show(!0)}}function CModalConfirm(parent,title,data,btnExitTitle,btnExitClick,btnOKTitle,btnOKClick){CModalAlert.call(this,parent,title,data,btnExitTitle,btnExitClick),this.name="CModalConfirm";var self=this;this.bpanel.Add(KEYS.OK,"ok.png",btnOKTitle,function(){self.Show(!1),"function"==typeof btnOKClick&&(btnOKClick.call(self),btnOKClick=null)})}var DEBUG=!0,DEBUG_NAME="",DEBUG_SERVER="",EMULATION=!1,PATH_MODE_WEB=!1,PATH_ROOT=null,PATH_SYSTEM=null,PATH_MEDIA="/media/",WINDOW_WIDTH=screen.width,WINDOW_HEIGHT=screen.height,URL_PARAMS={},initFound=!1,proxy;PATH_ROOT=location.pathname.split("/"),PATH_ROOT[PATH_ROOT.length-1]="",PATH_ROOT=PATH_ROOT.join("/"),PATH_ROOT=location.protocol+"//"+location.host+PATH_ROOT+PATH_BASE,PATH_SYSTEM=PATH_ROOT+"system/",document.location.search&&document.location.search.substring(1).split("&").forEach(function(part){part=part.split("="),2===part.length&&(URL_PARAMS[part[0]]=decodeURIComponent(part[1]))}),void 0===window.gSTB?(DEBUG=EMULATION=!0,DEBUG_SERVER=DEBUG_SERVER||localStorage.getItem("DEBUG_SERVER"),DEBUG_NAME=DEBUG_NAME||localStorage.getItem("DEBUG_NAME"),WINDOW_WIDTH=parseInt(URL_PARAMS.width,10)||window.outerWidth,WINDOW_HEIGHT=parseInt(URL_PARAMS.height,10)||window.outerHeight,document.write('<script type="text/javascript" src="'+PATH_SYSTEM+'gstb.js"></script>\n'),document.write('<script type="text/javascript" src="'+PATH_SYSTEM+'debug.js"></script>\n'),document.write('<script type="text/javascript" src="http://'+DEBUG_SERVER+':8800/file/client.js"></script>\n'),document.write('<script type="text/javascript">if ( window.proxyClient ) {proxy = new proxyClient();if ( DEBUG_NAME && DEBUG_SERVER ) proxy.init({name:"'+DEBUG_NAME+'", host:"'+DEBUG_SERVER+'"}); }</script>\n'),window.addEventListener("load",function(){document.body.style.backgroundColor="black"})):(gSTB.SetNativeStringMode(!0),function(){var vars=JSON.parse(gSTB.GetEnv(JSON.stringify({varList:["debug","debug_name","debug_server"]})));!vars.errMsg&&vars.result&&(DEBUG="1"===vars.result.debug,DEBUG&&!URL_PARAMS.nodebug&&(document.write('<script type="text/javascript" src="'+PATH_SYSTEM+'debug.js"></script>\n'),DEBUG_NAME=DEBUG_NAME||vars.result.debug_name,DEBUG_SERVER=DEBUG_SERVER||vars.result.debug_server,DEBUG_NAME&&DEBUG_SERVER&&"1"!==stbStorage.getItem("spyjs.active")&&document.write('<script type="text/javascript" src="http://'+DEBUG_SERVER+":8000/target/target-script-min.js#"+DEBUG_NAME+'"></script>\n')))}());var PATH_IMG_SYSTEM=PATH_SYSTEM+"img/"+WINDOW_WIDTH+"/",PATH_IMG_PUBLIC=PATH_ROOT+"public/img/"+WINDOW_WIDTH+"/",WINDOWS={PORTAL:"portal",HELP:"help",DOWNLOAD_MANAGER:"dlman",PVR:"recordsManager",BROWSER:"ibman",BROWSER_VIEW:"ibmanView",PORTALS_LOADER:"portalsLoader",SYSTEM_SETTINGS:"systemSettings"},KEYS={BACK:8,NUM1:49,NUM2:50,NUM3:51,NUM4:52,NUM5:53,NUM6:54,NUM7:55,NUM8:56,NUM9:57,NUM0:48,DELETE:46,CHANNEL_PREV:1009,CHANNEL_NEXT:9,OK:13,EXIT:27,UP:38,DOWN:40,LEFT:37,RIGHT:39,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,VOLUME_UP:107,VOLUME_DOWN:109,F1:112,F2:113,F3:114,F4:115,REFRESH:116,FRAME:117,PHONE:119,EPG:119,SET:120,TV:121,MENU:122,WEB:123,MIC:2032,REWIND:2066,FORWARD:2070,APP:2076,USB_MOUNTED:2080,USB_UNMOUNTED:2081,PLAY_PAUSE:2082,STOP:2083,POWER:2085,RECORD:2087,INFO:2089,MUTE:2192,CLOCK:2032,AUDIO:2071,KEYBOARD:2076},gettext=function(){var module={},data=null;return module.init=function(options,onReady){options.name=options.name||"en",options.ext=options.ext||"js",options.path=options.path||"lang",data=null,"en"!==options.name?loadScript(options.path+"/"+options.name+"."+options.ext,onReady,onReady):"function"==typeof onReady&&onReady()},module.load=function(input){data=input},module.data=function(key){return null===data?key:void 0!==data[key]?data[key]:key},module}(),_=gettext.data;if(void 0===window.echo&&(window.echo=function(data,title){}),ajax.stop=!1,parseUri.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},!("classList"in document.documentElement)){var prototype=Array.prototype,indexOf=prototype.indexOf,slice=prototype.slice,push=prototype.push,splice=prototype.splice,join=prototype.join;window.DOMTokenList=function(el){if(this._element=el,el.className!==this._classCache){if(this._classCache=el.className,!this._classCache)return;var i,classes=this._classCache.replace(/^\s+|\s+$/g,"").split(/\s+/);for(i=0;i<classes.length;i++)push.call(this,classes[i])}},window.DOMTokenList.prototype={add:function(token){this.contains(token)||(push.call(this,token),this._element.className=slice.call(this,0).join(" "))},contains:function(token){return-1!==indexOf.call(this,token)},item:function(index){return this[index]||null},remove:function(token){var i=indexOf.call(this,token);-1!==i&&(splice.call(this,i,1),this._element.className=slice.call(this,0).join(" "))},toString:function(){return join.call(this," ")},toggle:function(token){return this.contains(token)?this.remove(token):this.add(token),this.contains(token)}},Object.defineProperty(Element.prototype,"classList",{get:function(){return new window.DOMTokenList(this)}})}var Events={bind:function(event,callback){if(this._events||(this._events={}),"object"==typeof event)for(var name in event)this.bind(name,event[name]);else"string"==typeof event&&"function"==typeof callback&&(void 0===this._events[event]&&(this._events[event]=[]),this._events[event].push(callback))},trigger:function(event,data){var result,results=[],self=this;return void 0!==event&&void 0!==this._events&&void 0!==this._events[event]&&this._events[event].forEach(function(ev){result=ev.call(self,data),void 0!==result&&results.push(result)}),results},unbind:function(event){delete this._events[event]},inject:function(obj){"function"==typeof obj?extend(obj.prototype,this):"object"==typeof obj&&extend(obj,this)}},timeZoneOffsets={A:{index:-1,minutes:60},ACDT:{index:-1,minutes:60},ACST:{index:-1,minutes:570},ACT:{index:1,minutes:300},ACWST:{index:-1,minutes:525},ADT:{index:1,minutes:180},AEDT:{index:-1,minutes:61},AEST:{index:-1,minutes:60},AFT:{index:-1,minutes:270},AKDT:{index:1,minutes:480},AKST:{index:1,minutes:540},ALMT:{index:-1,minutes:360},AMST:{index:1,minutes:180},AMT:{index:1,minutes:240},ANAST:{index:-1,minutes:62},ANAT:{index:-1,minutes:62},AQTT:{index:-1,minutes:300},ART:{index:1,minutes:180},AST:{index:1,minutes:240},AWDT:{index:-1,minutes:540},AWST:{index:-1,minutes:480},AZOST:{index:0,minutes:0},AZOT:{index:1,minutes:60},AZST:{index:-1,minutes:300},AZT:{index:-1,minutes:240},B:{index:-1,minutes:120},BNT:{index:-1,minutes:480},BOT:{index:1,minutes:240},BRST:{index:1,minutes:120},BRT:{index:1,minutes:180},BST:{index:-1,minutes:60},BTT:{index:-1,minutes:360},C:{index:-1,minutes:180},CAST:{index:-1,minutes:480},CAT:{index:-1,minutes:120},CCT:{index:-1,minutes:390},CDT:{index:1,minutes:300},CEST:{index:-1,minutes:120},CET:{index:-1,minutes:60},CHADT:{index:-1,minutes:63},CHAST:{index:-1,minutes:62},CHOT:{index:-1,minutes:480},CHUT:{index:-1,minutes:600},CKT:{index:1,minutes:60},CLST:{index:1,minutes:180},CLT:{index:1,minutes:240},COT:{index:1,minutes:300},CST:{index:1,minutes:360},CVT:{index:1,minutes:60},CXT:{index:-1,minutes:420},ChST:{index:-1,minutes:60},D:{index:-1,minutes:240},DAVT:{index:-1,minutes:420},E:{index:-1,minutes:300},EASST:{index:1,minutes:300},EAST:{index:1,minutes:360},EAT:{index:-1,minutes:180},ECT:{index:1,minutes:300},EDT:{index:-1,minutes:61},EEST:{index:-1,minutes:180},EET:{index:-1,minutes:120},EGST:{index:0,minutes:0},EGT:{index:1,minutes:60},EST:{index:1,minutes:300},ET:{index:1,minutes:300},F:{index:-1,minutes:360},FET:{index:-1,minutes:180},FJST:{index:-1,minutes:63},FJT:{index:-1,minutes:62},FKST:{index:1,minutes:180},FKT:{index:1,minutes:240},FNT:{index:1,minutes:120},G:{index:-1,minutes:420},GALT:{index:1,minutes:360},GAMT:{index:1,minutes:540},GET:{index:-1,minutes:240},GFT:{index:1,minutes:180},GILT:{index:-1,minutes:62},GMT:{index:0,minutes:0},GST:{index:-1,minutes:240},GYT:{index:1,minutes:240},H:{index:-1,minutes:480},HAA:{index:1,minutes:180},HAC:{index:1,minutes:300},HADT:{index:1,minutes:540},HAE:{index:1,minutes:240},HAP:{index:1,minutes:420},HAR:{index:1,minutes:360},HAST:{index:1,minutes:60},HAT:{index:1,minutes:150},HAY:{index:1,minutes:480},HKT:{index:-1,minutes:480},HLV:{index:1,minutes:270},HNA:{index:1,minutes:240},HNC:{index:1,minutes:360},HNE:{index:1,minutes:300},HNP:{index:1,minutes:480},HNR:{index:1,minutes:420},HNT:{index:1,minutes:210},HNY:{index:1,minutes:540},HOVT:{index:-1,minutes:420},I:{index:-1,minutes:540},ICT:{index:-1,minutes:420},IDT:{index:-1,minutes:180},IOT:{index:-1,minutes:360},IRDT:{index:-1,minutes:270},IRKST:{index:-1,minutes:540},IRKT:{index:-1,minutes:540},IRST:{index:-1,minutes:210},IST:{index:-1,minutes:60},JST:{index:-1,minutes:540},K:{index:-1,minutes:60},KGT:{index:-1,minutes:360},KOST:{index:-1,minutes:660},KRAST:{index:-1,minutes:480},KRAT:{index:-1,minutes:480},KST:{index:-1,minutes:540},KUYT:{index:-1,minutes:240},L:{index:-1,minutes:61},LHDT:{index:-1,minutes:61},LHST:{index:-1,minutes:60},LINT:{index:-1,minutes:64},M:{index:-1,minutes:62},MAGST:{index:-1,minutes:62},MAGT:{index:-1,minutes:62},MART:{index:1,minutes:570},MAWT:{index:-1,minutes:300},MDT:{index:1,minutes:360},MESZ:{index:-1,minutes:120},MEZ:{index:-1,minutes:60},MHT:{index:-1,minutes:62},MMT:{index:-1,minutes:390},MSD:{index:-1,minutes:240},MSK:{index:-1,minutes:240},MST:{index:1,minutes:420},MUT:{index:-1,minutes:240},MVT:{index:-1,minutes:300},MYT:{index:-1,minutes:480},N:{index:1,minutes:60},NCT:{index:-1,minutes:61},NDT:{index:1,minutes:150},NFT:{index:-1,minutes:61},NOVST:{index:-1,minutes:420},NOVT:{index:-1,minutes:360},NPT:{index:-1,minutes:345},NRT:{index:-1,minutes:720},NST:{index:1,minutes:210},NUT:{index:1,minutes:61},NZDT:{index:-1,minutes:63},NZST:{index:-1,minutes:62},O:{index:1,minutes:120},OMSST:{index:-1,minutes:420},OMST:{index:-1,minutes:420},ORAT:{index:-1,minutes:300},P:{index:1,minutes:180},PDT:{index:1,minutes:420},PET:{index:1,minutes:300},PETST:{index:-1,minutes:62},PETT:{index:-1,minutes:62},PGT:{index:-1,minutes:60},PHOT:{index:-1,minutes:63},PHT:{index:-1,minutes:480},PKT:{index:-1,minutes:300},PMDT:{index:1,minutes:120},PMST:{index:1,minutes:180},PONT:{index:-1,minutes:61},PST:{index:1,minutes:480},PT:{index:1,minutes:480},PWT:{index:-1,minutes:540},PYST:{index:1,minutes:180},PYT:{index:1,minutes:240},Q:{index:1,minutes:240},QYZT:{index:1,minutes:360},R:{index:1,minutes:300},RET:{index:-1,minutes:240},S:{index:1,minutes:360},SAKT:{index:1,minutes:600},SAMT:{index:-1,minutes:240},SAST:{index:-1,minutes:120},SBT:{index:-1,minutes:61},SCT:{index:-1,minutes:240},SGT:{index:-1,minutes:480},SRET:{index:-1,minutes:660},SRT:{index:1,minutes:180},SST:{index:1,minutes:61},T:{index:1,minutes:420},TAHT:{index:1,minutes:60},TFT:{index:-1,minutes:300},TJT:{index:-1,minutes:300},TKT:{index:-1,minutes:63},TLT:{index:-1,minutes:540},TMT:{index:-1,minutes:300},TOT:{index:-1,minutes:780},TVT:{index:-1,minutes:62},U:{index:1,minutes:480},ULAT:{index:-1,minutes:480},UTC:{index:0,minutes:0},UYST:{index:1,minutes:120},UYT:{index:1,minutes:180},UZT:{index:-1,minutes:300},V:{index:1,minutes:540},VET:{index:1,minutes:270},VLAST:{index:-1,minutes:61},VLAT:{index:-1,minutes:61},VUT:{index:-1,minutes:61},W:{index:1,minutes:60},WARST:{index:1,minutes:180},WAST:{index:-1,minutes:120},WAT:{index:-1,minutes:60},WEST:{index:-1,minutes:60},WESZ:{index:-1,minutes:60},WET:{index:0,minutes:0},WEZ:{index:0,minutes:0},WFT:{index:-1,minutes:62},WGST:{index:1,minutes:120},WGT:{index:1,minutes:180},WIB:{index:-1,minutes:420},WIT:{index:-1,minutes:540},WITA:{index:-1,minutes:480},WST:{index:-1,minutes:63},WT:{index:0,minutes:0},X:{index:1,minutes:61},Y:{index:1,minutes:62},YAKST:{index:-1,minutes:60},YAKT:{index:-1,minutes:60},YAPT:{index:-1,minutes:60},YEKST:{index:-1,minutes:360},YEKT:{index:-1,minutes:360},Z:{index:0,minutes:0},"-12":{index:-1,minutes:720},"-11":{index:-1,minutes:660},"-10":{index:-1,minutes:600},"-09":{index:-1,minutes:540},"-08":{index:-1,minutes:480},"-07":{index:-1,minutes:420},"-06":{index:-1,minutes:360},"-05":{index:-1,minutes:300},"-04":{index:-1,minutes:240},"-03":{index:-1,minutes:180},"-02":{index:-1,minutes:120},"-01":{index:-1,minutes:60},"+01":{index:1,minutes:60},"+02":{index:1,minutes:120},"+03":{index:1,minutes:180},"+04":{index:1,minutes:240},"+05":{index:1,minutes:300},"+06":{index:1,minutes:360},"+07":{index:1,minutes:420},"+08":{index:1,minutes:480},"+09":{index:1,minutes:540},"+10":{index:1,minutes:600},"+11":{index:1,minutes:660},"+12":{index:1,minutes:720}};Array.prototype.shuffle=function(){for(var i,tmp,n=this.length;n--;)i=Math.floor(n*Math.random()),tmp=this[i],this[i]=this[n],this[n]=tmp;return this},CBase.prototype.SetParent=function(parent){parent instanceof CBase&&(this.parent=parent)},CBase.prototype.Init=function(handle){if(handle&&handle.nodeName){this.handle=handle,this.baseClass&&-1===handle.className.indexOf(this.baseClass)?this.handleInner=this.handle.appendChild(element("div",{className:this.baseClass})):this.handleInner=this.handle;var self=this;this.handle.addEventListener("click",function(event){"function"==typeof self.onClick&&self.onClick()===!1&&event.stopPropagation()}),"function"==typeof this.onInit&&this.onInit()}},CBase.prototype.Activate=function(active){this.isActive=active!==!1,this.isActive?("function"==typeof this.onActivate&&this.onActivate(),this.parent&&(this.parent.activeChild&&this.parent.activeChild!==this&&this.parent.activeChild.Activate(!1),this.parent.activeChild=this)):("function"==typeof this.onDeactivate&&this.onDeactivate(),this.parent&&(this.parent.activeChild=null))},CBase.prototype.Show=function(visible,manageFocus){var success=!1;return this.handle&&(this.isVisible=visible!==!1,this.isVisible?this.handle.style.display!==this.showAttr&&(this.prevFocus=document.activeElement,manageFocus!==!1&&document.activeElement&&document.activeElement.blur(),this.handle.style.display=this.showAttr,manageFocus!==!1&&this.handle.focus(),"function"==typeof this.onShow&&this.onShow(),success=!0):"none"!==this.handle.style.display&&(manageFocus!==!1&&document.activeElement&&document.activeElement.blur(),this.handle.style.display="none",manageFocus!==!1&&this.prevFocus&&this.prevFocus.focus(),"function"==typeof this.onHide&&this.onHide(),this.isActive&&this.Activate(!1),success=!0)),success},CBase.prototype.Visible=function(mode){this.handle.style.visibility=Boolean(mode)?"visible":"hidden"},CBase.prototype.EventHandler=null,CBase.prototype.onInit=null,CBase.prototype.onShow=null,CBase.prototype.onHide=null,CBase.prototype.onActivate=null,CBase.prototype.onDeactivate=null,CBase.prototype.onClick=function(){return this.Activate(!0),!0},CPage.prototype=Object.create(CBase.prototype),CPage.prototype.constructor=CPage,CPage.prototype.Show=function(visible,previous){visible===!1?(this.activeChild&&this.activeChild.Activate(!1),CBase.prototype.Show.call(this,!1,!0,!0),window.currCPage=this.previous||window.baseCPage,this.previous=null,window.currCPage&&window.currCPage!==this&&CBase.prototype.Show.call(window.currCPage,!0,!0,!0)):(this.previous=previous||null,window.currCPage&&window.currCPage!==this&&(window.currCPage.activeChild&&window.currCPage.activeChild.Activate(!1),CBase.prototype.Show.call(window.currCPage,!1,!0,!0)),CBase.prototype.Show.call(this,!0,!0,!0),window.currCPage=this)},CPage.prototype.onClick=function(){return!1},CPage.prototype.EventHandler=function(){},CScrollList.prototype=Object.create(CBase.prototype),CScrollList.prototype.constructor=CScrollList,CScrollList.prototype.Init=function(handle){CBase.prototype.Init.call(this,handle);var self=this;this.handleInner.onmousewheel=function(event){var direction=event.wheelDeltaY>0,found=self.Next(null,direction);return found&&(self.MoveNext(direction?-1:1),self.Focused(found,!0)),event.stopPropagation(),!1}},CScrollList.prototype.Add=function(body,attrs){attrs=attrs||{};var item=element("a",this.defaultParams,body);this.renderMode===this.RENDER_MODE_BULK?this.fragment.appendChild(item):this.handleInner.appendChild(item),attrs.hidden&&this.Hidden(item,!0),attrs.marked&&this.Marked(item,!0),attrs.disabled&&this.Disabled(item,!0),attrs.focused&&this.Focused(item,!0,attrs.manageFocus);for(var name in attrs)attrs.hasOwnProperty(name)&&(item[name]=attrs[name]);return item},CScrollList.prototype.Render=function(){this.fragment.childNodes.length>0&&this.handleInner.appendChild(this.fragment)},CScrollList.prototype.Clear=function(){this.handleInner.innerHTML=null,this.activeItem=null,this.states={}},CScrollList.prototype.Reset=function(item){item&&item.nodeName&&(this.Hidden(item,this.defaultParams.hidden),this.Marked(item,this.defaultParams.marked),this.Disabled(item,this.defaultParams.disabled),this.Focused(item,this.defaultParams.focused),item!==this.activeItem||item.focused||(this.activeItem=null))},CScrollList.prototype.DeleteAll=function(items){var self=this,curPos=null;Array.isArray(items)&&items.length>0&&(null!==document.activeElement&&document.activeElement.parentNode===this.handleInner&&document.activeElement.blur(),-1===items.indexOf(this.Current())?curPos=this.Current():(curPos=this.Next({marked:!1,hidden:!1,disabled:!1}),(null===curPos||curPos===this.Current())&&(curPos=this.Next({marked:!1,hidden:!1,disabled:!1},!0))),items.forEach(function(item){self.Delete(item)}),null!==curPos&&(this.Focused(curPos,!0),this.SetPosition(curPos,!0)))},CScrollList.prototype.Delete=function(item){if(item&&item.nodeName&&item.parentNode===this.handleInner){for(var name in this.states)if(this.states.hasOwnProperty(name)){var index=this.states[name].indexOf(item);-1!==index&&this.states[name].splice(index,1)}item===this.activeItem&&(this.activeItem=null),this.handleInner.removeChild(item)}},CScrollList.prototype.Current=function(){return this.activeItem},CScrollList.prototype.Length=function(){return this.handleInner.children.length+this.fragment.childNodes.length},CScrollList.prototype.SetState=function(item,option,state){if(state=Boolean(state),item[option]!==state){this.states[option]||(this.states[option]=[]);var index=this.states[option].indexOf(item);state?-1===index&&this.states[option].push(item):-1!==index&&this.states[option].splice(index,1);var oldVal=item[option];return item[option]=state,state?item.classList.add(option):item.classList.remove(option),"function"==typeof this.onStateChange&&this.onStateChange(item,option,oldVal,state),!0}return!1},CScrollList.prototype.Hidden=function(item,state){if(state=Boolean(state),item&&item.nodeName){var changed=this.SetState(item,"hidden",state);return changed&&state&&(item.focused&&(this.activeItem=null),this.SetState(item,"marked",!1),this.SetState(item,"focused",!1)),changed}return!1},CScrollList.prototype.Marked=function(item,state){var self=this;return state=Boolean(state),item&&item.nodeName&&!item.disabled&&!item.hidden?(this.multipleSelection===!1&&(this.states.marked||[]).forEach(function(marked){self.SetState(marked,"marked",!1)}),this.SetState(item,"marked",state)):!1},CScrollList.prototype.Disabled=function(item,state){if(state=Boolean(state),item&&item.nodeName){var changed=this.SetState(item,"disabled",state);return changed&&state&&(item.focused&&(this.activeItem=null),this.SetState(item,"marked",!1),this.SetState(item,"focused",!1)),changed}return!1},CScrollList.prototype.Focused=function(item,state,manageFocus){var changed=!1,prevent=!1;return state=state!==!1,void 0===manageFocus&&(manageFocus=this.manageFocus),item&&item.nodeName&&!item.disabled&&!item.hidden&&state!==item.focused&&(state?item!==this.activeItem&&("function"==typeof this.onFocus&&(prevent=this.onFocus(item,this.activeItem)),prevent||(changed=this.SetState(item,"focused",state),this.Focused(this.activeItem,!1,manageFocus),this.activeItem=item,manageFocus!==!1&&this.activeItem.focus())):(changed=this.SetState(item,"focused",state),manageFocus!==!1&&this.activeItem.blur(),this.activeItem=null)),changed},CScrollList.prototype.Activate=function(state,manageFocus){if(void 0===manageFocus&&(manageFocus=this.manageFocus),CBase.prototype.Activate.call(this,state),this.isActive){if(this.activeItem=this.activeItem||this.FindOne(),null===this.activeItem)return!1;this.SetState(this.activeItem,"focused",!0),this.SetPosition(this.activeItem),manageFocus!==!1&&this.activeItem.focus()}else this.activeItem&&this.activeItem.blur();return!0},CScrollList.prototype.Each=function(callback){Array.prototype.forEach.call(this.handleInner.children,callback)},CScrollList.prototype.Find=function(filter,limit,reverse){var match,found=[],items=this.handleInner.children,itlen=items.length,citem=null;
filter=filter||this.defaultFilter;for(var i=0;itlen>i;i++){citem=items[reverse?itlen-i-1:i],match=!0;for(var attr in filter)filter.hasOwnProperty(attr)&&(match=match&&citem[attr]===filter[attr]);if(match&&(found.push(citem),limit&&found.length>=limit))break}return found},CScrollList.prototype.FindOne=function(filter,reverse){return this.Find(filter,1,reverse).pop()||null},CScrollList.prototype.Next=function(filter,reverse,nskip,toend){var match,suitable=this.activeItem,pointer=this.activeItem,skipcount=0;if(nskip=nskip||0,pointer)for(filter=filter||this.defaultFilter;pointer=reverse?pointer.previousSibling:pointer.nextSibling;){match=!0;for(var attr in filter)filter.hasOwnProperty(attr)&&(match=match&&pointer[attr]===filter[attr]);if(pointer.hidden||skipcount++,match&&(toend!==!1&&(suitable=pointer),0===nskip||nskip>0&&skipcount>=nskip))return pointer}return suitable},CScrollList.prototype.SetPosition=function(item,makeFocused,manageFocus){var index,page;makeFocused&&(void 0===manageFocus&&(manageFocus=this.manageFocus),this.Focused(item||this.FindOne(),!0,manageFocus)),null!==this.activeItem&&(index=this.activeItem.offsetTop/this.itemHeight,page=Math.floor(index/this.itemsPerPage),1===this.scrollMode?this.handleInner.scrollTop=(index-Math.floor((this.itemsPerPage-1)/2))*this.itemHeight:2===this.scrollMode&&(this.handleInner.scrollTop=this.itemsPerPage*this.itemHeight*page))},CScrollList.prototype.EventHandler=function(event,filter,manageFocus){var found=null;if(void 0===manageFocus&&(manageFocus=this.manageFocus),event.stopped!==!0){switch(event.code){case KEYS.PAGE_UP:case KEYS.PAGE_DOWN:found=this.Next(filter,event.code!==KEYS.PAGE_DOWN,this.itemsPerPage),this.handleInner.scrollTop=this.handleInner.scrollTop+(event.code===KEYS.PAGE_UP?-1:1)*this.itemsPerPage*this.itemHeight;break;case KEYS.LEFT:case KEYS.RIGHT:case KEYS.HOME:case KEYS.END:found=this.FindOne(filter,event.code===KEYS.RIGHT||event.code===KEYS.END);break;case KEYS.UP:case KEYS.DOWN:found=this.Next(filter,event.code===KEYS.UP),this.MoveNext(event.code===KEYS.UP?-1:1);break;case KEYS.OK:return this.activeItem&&this.activeItem.onclick(),void event.preventDefault();default:return}event.preventDefault(),this.Focused(found||this.FindOne(filter),!0,manageFocus)}},CScrollList.prototype.MoveNext=function(direction){null!==this.activeItem&&(1===this.scrollMode?this.handleInner.scrollTop=this.activeItem.offsetTop-Math.floor((this.itemsPerPage-1)/2)*this.itemHeight+direction*this.itemHeight:2===this.scrollMode&&(-1===direction?this.activeItem.offsetTop===this.handleInner.scrollTop&&(this.handleInner.scrollTop=this.handleInner.scrollTop-this.itemsPerPage*this.itemHeight):this.activeItem.offsetTop-this.handleInner.scrollTop===(this.itemsPerPage-1)*this.itemHeight&&(this.handleInner.scrollTop=this.handleInner.scrollTop+this.itemsPerPage*this.itemHeight)))},CScrollList.prototype.onFocus=null,CScrollList.prototype.onStateChange=null,Object.defineProperty(CScrollList.prototype,"itemsPerPage",{get:function(){return this._itemsPerPage?this._itemsPerPage:this._itemsPerPage=Math.round(this.handleInner.offsetHeight/this.handleInner.firstChild.offsetHeight)}}),Object.defineProperty(CScrollList.prototype,"itemHeight",{get:function(){return this.handleInner.firstChild?this.handleInner.firstChild.offsetHeight:0}}),CButtonPanel.prototype=Object.create(CBase.prototype),CButtonPanel.prototype.constructor=CButtonPanel,CButtonPanel.prototype.Init=function(path,handle){this.path=path,handle&&handle.nodeName?CBase.prototype.Init.call(this,handle):CBase.prototype.Init.call(this,element("div",{className:"cbpanel-main"}))},CButtonPanel.prototype.Add=function(code,icon,text,callback,hidden){var html=null,self=this,func=function(){self.isActive&&"function"==typeof callback&&(gSTB.HideVirtualKeyboard(),callback(code))};text&&(html=element("div",{className:"cbpanel-text",onclick:func}),html.innerHTML=text);var item=element("div",{className:"cbpanel-item",data:{code:code,onclick:func}},[element("img",{className:"cbpanel-icon",onclick:func,src:this.path+"/"+icon}),html]);return item.$name=html,this.Hidden(item,hidden||!1),elchild(this.handleInner,item),item},CButtonPanel.prototype.Hidden=function(item,state){item&&item.nodeName&&item.data.hidden!==state&&(item.data.hidden=state,item.style.display=state?"none":"table-cell")},CButtonPanel.prototype.SetName=function(item,name){var html=null;item&&item.nodeName&&name&&(item.$name?this.Rename(item,name):(html=element("div",{className:"cbpanel-text",onclick:item.data.onclick}),html.innerHTML=name,item.$name=html,item.appendChild(html)))},CButtonPanel.prototype.Rename=function(item,name){item&&item.nodeName&&(item.$name.innerHTML=name)},CButtonPanel.prototype.Activate=function(active){this.isActive=active!==!1},CButtonPanel.prototype.EventHandler=function(event){if(event.stopped!==!0&&this.isActive)for(var data,i=0,items=this.handleInner.children,length=items.length;length>i;i++)if(data=items[i].data,!data.hidden&&data.code===event.code&&"function"==typeof data.onclick)return void(data.onclick()&&event.preventDefault())},CButtonPanel.prototype.onClick=function(){return!1};var CMODAL_IMG_PATH=window.configuration&&configuration.newRemoteControl?PATH_IMG_SYSTEM+"buttons/new/":PATH_IMG_SYSTEM+"buttons/old/";CModal.prototype=Object.create(CPage.prototype),CModal.prototype.constructor=CModal,CModal.prototype.Init=function(body){CPage.prototype.Init.call(this,element("div",{className:this.baseClass},element("div",{className:"cmodal-cell"},body)));var owner=this.parent&&this.parent.handle&&this.parent.handle.nodeName?this.parent.handle:document.body;this.parent instanceof CModal&&this.parent.parent&&(owner=this.parent.parent.handle),owner.appendChild(this.handle)},CModal.prototype.Free=function(){this.handle&&this.handle.parentNode&&this.handle.parentNode.removeChild(this.handle),elclear(this.handle)},CModal.prototype.Show=function(visible,manageFocus){CBase.prototype.Show.call(this,visible,manageFocus!==!1),visible===!1?window.currCPage=this.parent:window.currCPage=this},CModal.prototype.FocusPrev=function(event,manageVK){if(this.focusList.length>0){--this.focusPos<0&&(this.focusPos=this.focusList.length-1);var el=this.focusList[this.focusPos];manageVK!==!1&&gSTB.HideVirtualKeyboard(),el.focus(),event&&"INPUT"===el.tagName&&"text"===el.type&&(event.preventDefault(),manageVK!==!1&&gSTB.ShowVirtualKeyboard())}},CModal.prototype.FocusNext=function(event,manageVK){if(this.focusList.length>0){++this.focusPos>=this.focusList.length&&(this.focusPos=0);var el=this.focusList[this.focusPos];manageVK!==!1&&gSTB.HideVirtualKeyboard(),el.focus(),event&&"INPUT"===el.tagName&&"text"===el.type&&(event.preventDefault(),manageVK!==!1&&gSTB.ShowVirtualKeyboard())}},CModalBox.prototype=Object.create(CModal.prototype),CModalBox.prototype.constructor=CModalBox,CModalBox.prototype.SetData=function(place,data){return elclear(place),data instanceof Node||Array.isArray(data)?elchild(place,data):place.innerHTML=data,data&&data.nodeName&&(data.style.display="block"),place.style.display=data?"block":"none",place},CModalBox.prototype.SetHeader=function(data){return this.SetData(this.header,data||"")},CModalBox.prototype.SetContent=function(data){return this.SetData(this.content,data||"")},CModalBox.prototype.SetFooter=function(data){return this.SetData(this.footer,data||"")},CModalBox.prototype.Init=function(){CModal.prototype.Init.call(this,element("div",{className:"cmodal-body"},[this.header,this.content,this.footer]))},CModalHint.prototype=Object.create(CModalBox.prototype),CModalHint.prototype.constructor=CModalHint,CModalAlert.prototype=Object.create(CModalBox.prototype),CModalAlert.prototype.constructor=CModalAlert,CModalConfirm.prototype=Object.create(CModalAlert.prototype),CModalConfirm.prototype.constructor=CModalConfirm;var configuration=function(){var config={newRemoteControl:!1,allowMulticastUpdate:!1,videoOutputMode:[{value:"Auto",title:"Auto",translated:!1},{value:"PAL",title:"PAL (576i)",translated:!0},{value:"576p-50",title:"576p-50",translated:!0},{value:"720p-50",title:"720p-50",translated:!0},{value:"1080i-50",title:"1080i-50",translated:!0},{value:"1080p-50",title:"1080p-50",translated:!0},{value:"NTSC",title:"NTSC (480i)",translated:!0},{value:"720p-60",title:"720p-60",translated:!0},{value:"1080i-60",title:"1080i-60",translated:!0},{value:"1080p-60",title:"1080p-60",translated:!0}]},model=gSTB.GetDeviceModelExt(),control=null;switch(model){case"AuraHD2":case"AuraHD3":case"AuraHD8":case"MAG275":case"WR320":config.newRemoteControl=!0;break;case"MAG256":case"MAG257":config.videoOutputMode=[{value:"Auto",title:"Auto",translated:!1},{value:"PAL",title:"PAL (576i)",translated:!0},{value:"720p-50",title:"720p-50",translated:!0},{value:"1080i-50",title:"1080i-50",translated:!0},{value:"1080p-50",title:"1080p-50",translated:!0},{value:"NTSC",title:"NTSC (480i)",translated:!0},{value:"720p-60",title:"720p-60",translated:!0},{value:"1080i-60",title:"1080i-60",translated:!0},{value:"1080p-60",title:"1080p-60",translated:!0}];break;case"MAG351":case"MAG352":case"MAG424":case"MAG425":config.videoOutputMode=[{value:"Auto",title:"Auto",translated:!1},{value:"PAL",title:"PAL (576i)",translated:!0},{value:"576p-50",title:"576p-50",translated:!0},{value:"720p-50",title:"720p-50",translated:!0},{value:"1080i-50",title:"1080i-50",translated:!0},{value:"1080p-50",title:"1080p-50",translated:!0},{value:"NTSC",title:"NTSC (480i)",translated:!0},{value:"720p-60",title:"720p-60",translated:!0},{value:"1080i-60",title:"1080i-60",translated:!0},{value:"1080p-60",title:"1080p-60",translated:!0},{value:"3840x2160p50",title:"3840x2160p-50",translated:!0},{value:"3840x2160p60",title:"3840x2160p-60",translated:!0}]}try{control=JSON.parse(gSTB.GetEnv('{"varList":["controlModel"]}')),!control.errMsg&&control.result&&control.result.controlModel&&("SRC4513"===control.result.controlModel?config.newRemoteControl=!0:config.newRemoteControl=!1)}catch(e){echo(e,"controlModel parse")}return config}(),accessControl=function(){function CModalAccessControl(ok,exit,noExit){var self=this,html=element("table",{className:"main maxw"},[element("tr",{},[element("td",{className:"name"},_("Password")),element("td",{className:"data"},this.pass=element("input",{type:"password"}))])]);this.pass.onkeydown=function(event){if(eventPrepare(event,!1,"CModalAccessControl"))switch(event.code){case KEYS.CHANNEL_NEXT:case KEYS.CHANNEL_PREV:event.preventDefault();break;case KEYS.UP:case KEYS.DOWN:break;case KEYS.OK:}},this.onShow=function(){setTimeout(function(){self.pass.focus()},5)},CModalAlert.call(this,accessControl.parent||currCPage,_("Unlock"),html,_("Cancel"),exit),this.focusList.push(this.pass),this.onHide=function(){elclear(self.bpanel.handle),delete self.bpanel,self.Free(),gSTB.EnableAppButton(!0)},this.name="CModalAccessControl",this.bpanel.Add(KEYS.OK,"ok.png",_("Ok"),function(){accessControl.login(self.pass.value)&&(self.Show(!1),gSTB.EnableAppButton(!0),"function"==typeof ok&&ok())}),noExit&&this.bpanel.Hidden(this.bpanel.btnExit,!0)}function CModalAccessControlLogOut(portals){var text,self=this;text=_(portals?"Lock device or exit portal?":"Lock device?"),CModalAlert.call(this,accessControl.parent||currCPage,_("Confirm"),text,_("Cancel")),this.focusList.push(this.pass),this.name="CModalAccessControlLogOut",this.bpanel.Add(KEYS.OK,"ok.png",_("Lock"),function(){accessControl.logout(),self.Show(!1),accessControl.showLoginForm(null,null,accessControl.data.events.portalOpen)}),portals&&this.bpanel.Add(KEYS.BACK,"back.png",_("Exit portal"),function(){accessControl.logout(),window.location=PATH_SYSTEM+"pages/loader/index.html"})}var env;return CModalAccessControl.prototype=Object.create(CModalAlert.prototype),CModalAccessControl.prototype.constructor=CModalAccessControl,CModalAccessControlLogOut.prototype=Object.create(CModalAlert.prototype),CModalAccessControlLogOut.prototype.constructor=CModalAccessControlLogOut,{state:!1,password:null,loginForm:null,data:{pages:{},events:{}},login:function(password,noEvent){return password!==this.password?!1:(this.state=!1,stbStorage.setItem("accessControl",this.state),noEvent||stbWebWindow.messageBroadcast("accessControl",this.state),!0)},logout:function(){this.password=env.acPassword,env.accessControl?this.state=!0:this.state=!1,stbWebWindow.messageBroadcast("accessControl",this.state),stbStorage.setItem("accessControl",this.state)},showLoginForm:function(ok,exit,noExit){return gSTB.EnableAppButton(!1),this.loginForm=new CModalAccessControl(ok,exit,noExit),this.loginForm},showLogoutForm:function(portals){return new CModalAccessControlLogOut(portals)},init:function(parent){var text,stb,self=this;if(window.environment)env=environment;else try{env=JSON.parse(gSTB.GetEnv(JSON.stringify({varList:["acPassword","accessControl"]}))).result,env.accessControl="true"===env.accessControl?!0:!1}catch(e){echo(e,"Environment load"),env={}}stbEvent.bind("broadcast.accessControl",function(data){echo(data.data,"broadcast.accessControl"),self.loginForm&&self.loginForm.Show(!1),self.state="true"===data.data}),this.parent=parent;try{text=gSTB.LoadUserData("access.control.json"),""!==text&&(this.data=JSON.parse(text))}catch(e){echo(e,"AccessControl parse")}stbStorage.getItem("accessControl")&&(stb="false"===stbStorage.getItem("accessControl")),env.acPassword=env.acPassword||"",env.accessControl&&(this.state=stb?!1:!0,this.password=env.acPassword),stbStorage.setItem("accessControl",this.state)},save:function(){gSTB.SaveUserData("access.control.json",JSON.stringify(this.data))}}}(),app=function(global){function mainEventListener(event){eventPrepare(event,!1,"mainEventListener "+currCPage.name)&&currCPage&&"function"==typeof currCPage.EventHandler&&currCPage.EventHandler(event)&&(event.preventDefault(),event.stopPropagation())}var module={};return gSTB.EnableServiceButton(!1),gSTB.EnableAppButton(!1),gSTB.EnableTvButton(!1),gSTB.SetScreenSaverTime(0),stbStorage.setItem(getWindowKey(WINDOWS.PORTALS_LOADER),stbWebWindow.windowId()),gSTB.SetSettingsInitAttr(JSON.stringify({url:PATH_SYSTEM+"settings/index.html",backgroundColor:"#000"})),module.init=function(){echo("initialization start");var portalsData,dataFromDHPC,wakeUpSources,envVars=module.data.getEnvData(),pageUrl=parseUri(window.location),controlData=module.data.getRCData();gSTB.InitPlayer(),gSTB.ConfigNetRc(controlData.deviceName,controlData.password),gSTB.SetNetRcStatus(controlData.enable),app.standByMode=parseInt(envVars.standByMode,10),"function"==typeof gSTB.GetWakeUpSources&&-1!==(gSTB.SupportedWakeUpSources||[]).indexOf(2)&&(wakeUpSources=gSTB.GetWakeUpSources()||[],0===envVars.hdmiEventDelay&&-1!==wakeUpSources.indexOf(2)?(wakeUpSources.splice(wakeUpSources.indexOf(2),1),gSTB.SetWakeUpSources(wakeUpSources)):0!==envVars.hdmiEventDelay&&-1===wakeUpSources.indexOf(2)&&(wakeUpSources.push(2),gSTB.SetWakeUpSources(wakeUpSources))),"function"==typeof gSTB.SetAutoPowerDownInitAttr&&(gSTB.SetAutoPowerDownInitAttr(JSON.stringify({url:PATH_SYSTEM+"pages/standby/index.html",backgroundColor:"transparent"})),gSTB.SetAutoPowerDownTime(envVars.autoPowerDownTime)),dataFromDHPC=module.data.getDHCPData(),gettext.init({name:getCurrentLanguage()},function(){function continueLoading(){module.isItErrorPage=!pageUrl.queryKey.bootmedia&&pageUrl.query,echo("is it 404 page? "+module.isItErrorPage),module.isItErrorPage&&(module.isItBlocked="true"===pageUrl.queryKey.blocked,pageUrl.queryKey.url?module.badUrl=decodeURIComponent(pageUrl.queryKey.url):module.badUrl=decodeURIComponent(pageUrl.query)),module.data.migration(envVars),portalsData=module.data.getPortals(),checkEnvVars(),envVars=module.data.getEnvData(),portalsData=module.data.checkForceEnvSet(portalsData,envVars);var is={case1:portalsData.enable&&!portalsData.empty,case2:envVars.portal1&&envVars.portal2&&!portalsData.enable,case3:portalsData.enable&&0===Number(portalsData.time),case4:dataFromDHPC.enable&&dataFromDHPC.url};module.isItErrorPage||envVars.portal1||envVars.portal2||is.case4||is.case1||(echo("There is no portal for loading. Redirecting to inner portal"),document.getElementById("loading").style.display="block",module.loadPortal(PATH_ROOT+"services.html")),module.view.init(),accessControl.init(),module.isItErrorPage||(is.case2||is.case3)&&!is.case4?module.view.showMainPage(portalsData,envVars):module.view.showFastLoadPage(envVars,portalsData,dataFromDHPC)}pageUrl.queryKey.fallbackstate||pageUrl.queryKey.btnstate?(stbStorage.setItem("nandEmergencyLoadingLogs",JSON.stringify({bootmedia:pageUrl.queryKey.bootmedia})),module.view.showWarningPage(continueLoading)):continueLoading()})},module.loadPortal=function(url){url=parseUri(decodeURI(url)),app.view.systemMonitoringTimer&&clearInterval(app.view.systemMonitoringTimer),module.view.mainPage&&module.view.mainPage.Show(!1),module.view.fastLoadPage&&module.view.fastLoadPage.Show(!1),gSTB.EnableServiceButton(!0),setTimeout(function(){url.protocol||(url.source=gSTB.IsFileExist(url.source)?"file:///"+url.source:"http://"+url.source),stbStorage.removeItem(getWindowKey(WINDOWS.PORTALS_LOADER)),stbStorage.removeItem(getWindowKey(WINDOWS.PORTAL)),echo(url.source,"LOAD PORTAL:"),window.location=url.source},10)},global.onload=module.init,document.addEventListener("keydown",mainEventListener),global.oncontextmenu=EMULATION?null:function(){return!1},module}(window),stbEvent={onEvent:function(data){},onMessage:function(from,message,data){this.trigger(message,{from:from,data:data})},onBroadcastMessage:function(from,message,data){echo(message,"onBroadcastMessage"),this.trigger("broadcast."+message,{from:from,data:data})},event:0};Events.inject(stbEvent),app.view=function(global){function showLoaderModeInfo(){var infoElement=module.mainPage.handleInner.querySelector(".header .info");infoElement.innerHTML=_("Select a portal for loading"),infoElement=module.mainPage.handleInner.querySelector(".content"),infoElement.className=infoElement.className+" loader"}function showErrorModeInfo(){var infoElement,answerOne,answerTwo,answerThree,infoBlock,errorClass,infoData=[];infoElement=module.mainPage.handleInner.querySelector(".header .info"),infoElement.innerHTML=_("Page loading error"),infoElement=module.mainPage.handleInner.querySelector(".content .infoList"),infoBlock=element("div",{className:"infoBlock"}),elchild(infoBlock,[element("div",{className:"title"},[element("div",{className:"internetIcon"}),element("div",{},_("Internet: ")),element("span",{className:"",id:"internet"},_("Enabled"))])]),infoData.push(infoBlock),infoBlock=element("div",{className:"infoBlock"}),answerOne=gSTB.RDir("IPAddress"),answerTwo=gSTB.GetDeviceMacAddress(),answerThree=gSTB.GetLanLinkStatus(),errorClass=answerTwo?"error":"",answerThree=_(answerThree?"Enabled":"Not connected"),elchild(infoBlock,[element("hr",{}),element("div",{className:"title"},[element("div",{className:"ethernetIcon"}),element("div",{},_("Ethernet: ")),element("span",{className:answerThree?"":errorClass,id:"ethernet"},answerThree)]),element("div",{},[_("IP: "),element("span",{className:answerOne?"":errorClass,id:"ethIP"},answerOne||_("Not available"))]),element("div",{},[_("MAC: "),element("span",{className:answerTwo?"":errorClass},answerTwo||_("Not available"))])]),infoData.push(infoBlock),infoBlock=element("div",{className:"infoBlock"}),answerOne=gSTB.RDir("WiFi_ip"),answerTwo=gSTB.GetNetworkWifiMac(),answerThree=gSTB.GetWifiLinkStatus(),errorClass=answerTwo?"error":"noDevice",answerThree=_(answerThree?"Enabled":"Not connected"),elchild(infoBlock,[element("hr",{}),element("div",{className:"title"},[element("div",{className:"wifiIcon"}),element("div",{},_("Wi-Fi: ")),element("span",{className:answerThree?"":errorClass,id:"wifi"},answerThree)]),element("div",{},[_("IP: "),element("span",{className:answerOne?"":errorClass,id:"wifiIP"},answerOne||_("Not available"))]),element("div",{},[_("MAC: "),element("span",{className:answerTwo?"":errorClass,id:"wifiMAC"},answerTwo||_("Not available"))])]),infoData.push(infoBlock),answerOne=gSTB.GetDeviceModelExt(),answerTwo=gSTB.GetDeviceImageDesc(),infoBlock=element("div",{className:"infoBlock"},[element("hr",{}),element("div",{},[_("Model: "),element("span",{className:"devInf"},answerOne)]),element("div",{},[_("Version: "),element("span",{className:"devInf"},answerTwo)])]),infoData.push(infoBlock),elchild(infoElement,infoData),infoElement.style.display="block",infoElement=module.mainPage.handleInner.querySelector(".content"),infoElement.className=infoElement.className+" page404",infoElement=module.mainPage.handleInner.querySelector(".header .info"),infoElement.className=infoElement.className+" page404",elchild(infoElement,element("span",{},_("Please check the connection and the page URL"))),sendPingRequest()}function setServiceItems(data){var arr=[],serviceItemsNumber=0,hasServSetItem=!1;return app.isItErrorPage&&app.badUrl&&!app.isItBlocked&&(arr.push({name:_("Try again"),url:app.badUrl,enable:!0}),serviceItemsNumber++),RULES.allowInnerPortal&&(arr.push({name:_("Embedded portal"),url:PATH_ROOT+"services.html",enable:!0,servItem:!0}),serviceItemsNumber++),(data.portals||[]).forEach(function(item){arr.push(item)}),(RULES["page404/allowSystemSettings"]&&app.isItErrorPage||RULES["portalsLoader/allowSystemSettings"]&&!app.isItErrorPage)&&(arr.push({name:_("System settings"),url:PATH_SYSTEM+"settings/index.html",enable:!0,servItem:!0}),hasServSetItem=!0),{arr:arr,serviceItemsNumber:serviceItemsNumber,hasServSetItem:hasServSetItem}}function getPortalType(url,name){var iconClass,urlByParts=parseUri(url);return iconClass="file://"+urlByParts.path==PATH_SYSTEM+"settings/index.html"?"settings":name===_("Try again")?"refresh":"http"===urlByParts.protocol||"https"===urlByParts.protocol?"internet":-1!==urlByParts.protocol.indexOf("file")||-1!==urlByParts.path.indexOf(PATH_ROOT)||-1!==urlByParts.path.indexOf(PATH_MEDIA)?"home":"local"}function sendPingRequest(){configuration.url.ping.length>0&&ajax("get",configuration.url.ping[sendPingRequest.linkIndex]+"?time="+Date.now(),function(data,status){var state=status>0&&"ok"===data,infoElement=document.getElementById("internet");infoElement.className=state?"":"error",infoElement.innerHTML=_(state?"Enabled":"Not available"),state?sendPingRequest.errorCount=0:(sendPingRequest.linkIndex=++sendPingRequest.linkIndex%configuration.url.ping.length,++sendPingRequest.errorCount>=configuration.url.pingAttempts?sendPingRequest.errorCount=0:sendPingRequest())})}function systemStateMonitoring(){var infoBlock=app.view.mainPage.handleInner.querySelector(".body .content .infoList"),oldInf={ethernetState:infoBlock.querySelector("#ethernet"),ethIP:infoBlock.querySelector("#ethIP"),wifiState:infoBlock.querySelector("#wifi"),wifiIP:infoBlock.querySelector("#wifiIP"),wifiMAC:infoBlock.querySelector("#wifiMAC")};app.view.systemMonitoringTimer=setInterval(function(){var newInf={ethernetState:gSTB.GetLanLinkStatus(),ethIP:gSTB.RDir("IPAddress"),wifiState:gSTB.GetWifiLinkStatus(),wifiIP:gSTB.RDir("WiFi_ip"),wifiMAC:gSTB.GetNetworkWifiMac()};echo(newInf,"newInf"),newInf.ethernetState!==("error"!==oldInf.ethernetState.className)&&(oldInf.ethernetState.className=newInf.ethernetState?"":"error",oldInf.ethernetState.innerHTML=_(newInf.ethernetState?"Enabled":"Not connected")),!!newInf.ethIP!=("error"!==oldInf.ethIP.className)&&(oldInf.ethIP.className=newInf.ethIP?"":"error",oldInf.ethIP.innerHTML=newInf.ethIP?newInf.ethIP:_("Not available")),newInf.wifiMAC?(newInf.wifiState!==("error"!==oldInf.wifiState.className&&"noDevice"!==oldInf.wifiState.className)&&(oldInf.wifiState.className=newInf.wifiState?"":"error",oldInf.wifiState.innerHTML=_(newInf.wifiState?"Enabled":"Disabled")),!!newInf.wifiIP!=("error"!==oldInf.wifiIP.className&&"noDevice"!==oldInf.wifiIP.className)&&(oldInf.wifiIP.className=newInf.wifiIP?"":"error",oldInf.wifiIP.innerHTML=newInf.wifiIP?newInf.wifiIP:_("Not available")),("error"===oldInf.wifiMAC.className||"noDevice"===oldInf.wifiMAC.className)&&(oldInf.wifiMAC.className="",oldInf.wifiMAC.innerHTML=newInf.wifiMAC)):"noDevice"!==oldInf.wifiMAC.className&&(oldInf.wifiState.className="noDevice",oldInf.wifiState.innerHTML=_("Disabled"),oldInf.wifiMAC.className="noDevice",oldInf.wifiMAC.innerHTML=_("Not available"),oldInf.wifiIP.className="noDevice",oldInf.wifiIP.innerHTML=_("Not available")),sendPingRequest()},5e3)}var module={};return module.init=function(){global.moveTo(0,0),window.resizeTo(EMULATION?window.outerWidth:screen.width,EMULATION?window.outerHeight:screen.height),module.mainPage=new CPage,module.mainPage.name="main",module.fastLoadPage=new CPage,module.fastLoadPage.name="fastLoadPage",window.currCPage=window.ServiceMenu=module.mainPage,module.mainPage.Init(document.body.children[0]),module.fastLoadPage.Init(document.body.children[1]),module.mainPage.portalList=new CScrollList(module.mainPage),module.mainPage.portalList.Init(module.mainPage.handleInner.querySelector(".content .cslist-main")),module.mainPage.modalDenied=new CModalBox(module.mainPage),module.mainPage.modalDenied.bpanel=new CButtonPanel,module.mainPage.modalDenied.bpanel.Init(global.CMODAL_IMG_PATH),module.mainPage.modalDenied.bpanel.btnExit=module.mainPage.modalDenied.bpanel.Add(KEYS.OK,"ok.png",_("Ok"),function(){module.mainPage.modalDenied.Show(!1)}),module.mainPage.modalDenied.SetHeader(_("Warning")),module.mainPage.modalDenied.SetContent([element("div",{},_("Access to the web page you were trying to visit has been blocked due to a report of copyright infringement.")),element("div",{},_("Please contact your IPTV service provider for more information."))]),module.mainPage.modalDenied.SetFooter(module.mainPage.modalDenied.bpanel.handle),module.mainPage.modalDenied.EventHandler=function(event){event.code===KEYS.OK&&(module.mainPage.modalDenied.Show(!1),event.preventDefault(),event.stopPropagation())},module.mainPage.modalDenied.Init(),module.standByMode=function(){var standByStatus=!gSTB.GetStandByStatus();return echo("PORTALS_LOADER.standByStatus="+standByStatus),gSTB.StandByMode!==app.standByMode&&(gSTB.StandByMode=app.standByMode),3===app.standByMode?(gSTB.SetLedIndicatorMode(2),gSTB.StandBy(standByStatus),void gSTB.SetLedIndicatorMode(1)):(gSTB.StandBy(standByStatus),void(standByStatus?gSTB.SetLedIndicatorMode(2):gSTB.SetLedIndicatorMode(1)))},stbEvent.bind("window.reload",function(){document.body.style.display="none",stbStorage.removeItem(getWindowKey(WINDOWS.PORTALS_LOADER)),window.location.reload()}),stbEvent.bind("portal.standbyMode",function(){console.log("got portal.standbyMode"),module.standByMode()})},module.showMainPage=function(data,envVars){echo("showMainPage");var someListItem,servNumb,servSetItm,newScheme,oldScheme,imageList=["bg.png","home.png","local.png","net.png","settings.png","refresh.png","info.png","lan.png","wifi.png","connect.png"].map(function(image){return PATH_IMG_SYSTEM+"loader/"+image}),dontShowUrls=RULES.hidePortalsURL||envVars.custom_url_hider,itemsArr=setServiceItems(data);servNumb=itemsArr.serviceItemsNumber,servSetItm=itemsArr.hasServSetItem,itemsArr=itemsArr.arr;for(var i=0;i<itemsArr.length;i++)newScheme=data.enable&&itemsArr[i].enable,oldScheme=!data.enable&&(servNumb+2>i||servSetItm&&i===itemsArr.length-1),(newScheme||oldScheme)&&itemsArr[i].url&&(itemsArr[i].name=itemsArr[i].name||_("Portal")+" "+(i-servNumb+1),someListItem=element("div",{className:getPortalType(itemsArr[i].url,itemsArr[i].name)},""),elchild(someListItem,[element("div",{className:"icon"},""),element("div",{className:"portalInfo"},[element("div",{className:dontShowUrls||itemsArr[i].servItem?"text single":"text"},itemsArr[i].name),element("div",{className:"url"},dontShowUrls||itemsArr[i].servItem?"":itemsArr[i].url)])]),module.mainPage.portalList.Add(someListItem,{url:itemsArr[i].url,onclick:function(){return-1===this.url.indexOf(PATH_SYSTEM+"settings/index.html")?app.loadPortal(this.url):gSTB.StartLocalCfg(),!1}}));app.isItErrorPage?(showErrorModeInfo(),systemStateMonitoring()):showLoaderModeInfo(),echo("image loading..."),imageLoader(imageList,function(){echo("ready","imageLoader"),module.mainPage.Show(!0),module.mainPage.portalList.Activate(!0,!0),module.mainPage.EventHandler=function(event){switch(echo("mainPage.EventHandler =>"+event.code),event.code){case KEYS.EXIT:break;case KEYS.SET:(RULES["page404/allowSystemSettings"]&&app.isItErrorPage||RULES["portalsLoader/allowSystemSettings"]&&!app.isItErrorPage)&&gSTB.StartLocalCfg();break;case KEYS.POWER:module.standByMode();break;default:module.mainPage.portalList.EventHandler(event)}},app.isItBlocked&&module.mainPage.modalDenied.Show(!0,!0),accessControl.state&&accessControl.data.events.loader&&window.setTimeout(function(){accessControl.showLoginForm(null,null,!0)},0)})},module.showFastLoadPage=function(envVars,portalsData,dataFromDHPC){echo("FastLoad");var correctPortalURL,imageList=["bg2.jpg","loading.png"].map(function(image){return PATH_IMG_SYSTEM+"loader/"+image});document.body.querySelector(".fastLoad .container .title ").innerHTML=_("Loading portal..."),document.body.querySelector(".fastLoad .container .second").innerHTML=RULES["portalsLoader/useExtPortalsPage"]?_("Press MENU to load portal selection screen"):"",echo("image loading..."),imageLoader(imageList,function(){echo("images has been loaded","imageLoader"),correctPortalURL=portalsData.enable?Number(portalsData.def)?portalsData.portals[portalsData.def-1].url:PATH_ROOT+"services.html":envVars.portal1||envVars.portal2,dataFromDHPC.enable&&dataFromDHPC.url&&(correctPortalURL=dataFromDHPC.url),module.fastLoadPage.Show(!0),accessControl.state&&accessControl.data.events.loader?window.setTimeout(function(){accessControl.showLoginForm(function(){app.view.fastLoadTimer=setTimeout(function(){module.fastLoadPage.Show(!1),app.loadPortal(correctPortalURL)},portalsData.enable?1e3*portalsData.time||3e3:3e3)},null,!0)},0):app.view.fastLoadTimer=setTimeout(function(){module.fastLoadPage.Show(!1),app.loadPortal(correctPortalURL)},portalsData.enable?1e3*portalsData.time||3e3:3e3),module.fastLoadPage.EventHandler=function(event){switch(echo("fastLoadPage.EventHandler =>"+event.code),event.code){case KEYS.OK:app.view.fastLoadTimer&&clearTimeout(app.view.fastLoadTimer),module.fastLoadPage.Show(!1),app.loadPortal(correctPortalURL);break;case KEYS.POWER:module.standByMode();break;case KEYS.MENU:RULES["portalsLoader/useExtPortalsPage"]!==!1&&(app.view.fastLoadTimer&&clearTimeout(app.view.fastLoadTimer),module.fastLoadPage.Show(!1),module.showMainPage(portalsData,envVars))}}})},module.showWarningPage=function(callback){module.warningPage=new CPage,module.warningPage.name="warningPage",module.warningPage.Init(document.body.children[2]);var imageList=["bg2.jpg"].map(function(image){return PATH_IMG_SYSTEM+"loader/"+image});echo("image loading..."),imageLoader(imageList,function(){var modal,timeLeft=20;module.warningPage.Show(!0),modal=new CModalBox(module.warningPage),modal.bpanel=new CButtonPanel,modal.bpanel.Init(global.CMODAL_IMG_PATH),modal.bpanel.btnExit=modal.bpanel.Add(KEYS.OK,"ok.png",_("Continue")+" (20)",function(){window.clearInterval(app.view.warningPageTimer),module.warningPage.Show(!1),callback()}),modal.SetHeader(_("Warning!")),modal.SetContent([element("div",{},_("The device is loaded in fault-protection mode.")),element("div",{},_("We recommend to update the software."))]),modal.SetFooter(modal.bpanel.handle),modal.EventHandler=function(event){event.code===KEYS.OK&&(window.clearInterval(app.view.warningPageTimer),module.warningPage.Show(!1),callback())},modal.Init(),modal.Show(!0,!0),app.view.warningPageTimer=setInterval(function(){timeLeft--,timeLeft>0?modal.bpanel.btnExit.$name.innerHTML=_("Continue")+" ("+timeLeft+")":(window.clearInterval(app.view.warningPageTimer),module.warningPage.Show(!1),callback())},1e3)})},configuration.url={ping:["http://echo-01.infomir.com/","http://echo-02.infomir.com/","http://echo-03.infomir.com/","http://echo-04.infomir.com/"].shuffle(),pingAttempts:3},sendPingRequest.errorCount=0,sendPingRequest.linkIndex=0,module}(window),app.data=function(){
var module={};return module.getPortals=function(){var data=gSTB.LoadUserData("portals.json");try{data=JSON.parse(data)}catch(err){return echo('JSON.parse(LoadUserData("portals.json")); -> ERROR ->'+err),{enable:!1}}return echo(data,'data JSON.parse(LoadUserData("portals.json"))'),(1===data.time||"1"===data.time)&&(data.time=3,gSTB.SaveUserData("portals.json",JSON.stringify(data))),data},module.getDHCPData=function(){var answer,data;return answer=gSTB.GetEnv(JSON.stringify({varList:["use_portal_dhcp","portal_dhcp"]})),answer=JSON.parse(answer),data=answer.result.errMsg?{enable:!1,url:""}:{enable:"true"===answer.result.use_portal_dhcp,url:answer.result.portal_dhcp}},module.getEnvData=function(){var answer,data;return answer=gSTB.GetEnv(JSON.stringify({varList:["portal1","portal2","custom_url_hider","autoPowerDownTime","standByMode","hdmi_event_delay"]})),answer=JSON.parse(answer),data=answer.result.errMsg?{portal1:"",portal2:"",custom_url_hider:!1,autoPowerDownTime:0,hdmi_event_delay:0}:{portal1:decodeURI(answer.result.portal1),portal2:decodeURI(answer.result.portal2),custom_url_hider:"true"===answer.result.custom_url_hider,standByMode:Number(answer.result.standByMode),hdmiEventDelay:Number(answer.result.hdmi_event_delay||0),autoPowerDownTime:Number(answer.result.autoPowerDownTime||0)}},module.getRCData=function(){var remoteControlFileData=gSTB.LoadUserData("remoteControl.json");try{remoteControlFileData=JSON.parse(remoteControlFileData)}catch(error){remoteControlFileData={enable:!1,deviceName:"",password:""},gSTB.SaveUserData("remoteControl.json",JSON.stringify(remoteControlFileData))}return remoteControlFileData},module.migration=function(envVars){var newPortalsFile;""===gSTB.LoadUserData("portals.json")&&(newPortalsFile={enable:!1,time:"0",def:0,portals:[{name:"",url:"",enable:!1},{name:"",url:"",enable:!1},{name:"",url:"",enable:!1},{name:"",url:"",enable:!1},{name:"",url:"",enable:!1},{name:"",url:"",enable:!1},{name:"",url:"",enable:!1},{name:"",url:"",enable:!1}]},envVars.portal1&&(newPortalsFile.def=1,newPortalsFile.portals[0].enable=!0,newPortalsFile.portals[0].name="",newPortalsFile.portals[0].url=envVars.portal1),envVars.portal2&&(newPortalsFile.def=2,newPortalsFile.portals[1].enable=!0,newPortalsFile.portals[1].name="",newPortalsFile.portals[1].url=envVars.portal2),gSTB.SaveUserData("portals.json",JSON.stringify(newPortalsFile)),echo("Migration completed. New portals data file saved"))},module.checkForceEnvSet=function(portalsData,envVars){var saveTrigger=!1;return portalsData.portals[0].url!==envVars.portal1&&(portalsData.def=envVars.portal1?1:portalsData.def,portalsData.portals[0].enable=envVars.portal1?!0:!1,portalsData.portals[0].name="",portalsData.portals[0].url=envVars.portal1,saveTrigger=!0),portalsData.portals[1].url!==envVars.portal2&&(portalsData.def=envVars.portal2?2:portalsData.def,portalsData.portals[1].enable=envVars.portal2?!0:!1,portalsData.portals[1].name="",portalsData.portals[1].url=envVars.portal2,saveTrigger=!0),saveTrigger&&(gSTB.SaveUserData("portals.json",JSON.stringify(portalsData)),echo("force environmental vars set completed. New portals data file saved")),portalsData.empty=!portalsData.portals.some(function(item){return item.url&&item.enable}),portalsData},module}();